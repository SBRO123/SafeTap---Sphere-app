<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SafeTap Sphere ‚Äî Hackathon </title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
  <link rel="stylesheet" href="safeStyling.css">
</head>
<body>
  <div class="app">
    <nav class="topnav">
      <button data-screen="home" class="active">HOME</button>
      <button data-screen="sos">SOS</button>
      <button data-screen="map">MAP</button>
      <button data-screen="report">REPORT</button>
      <button data-screen="support">SUPPORT</button>
      <button data-screen="education">EDUCATION</button>
      <button data-screen="admin">ADMIN</button>
      <button data-screen="settings">SETTINGS</button>
    </nav>
    
    <main>
      
      <section id="home" class="screen active" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #d5c1c1);">
        <div style="text-align: center; margin-bottom: 32px;">
<h1 style="font-size: 3rem; background: linear-gradient(135deg, var(--accent-1), var(--accent-2)); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 16px;">üîí SAFE TAP SPHERE</h1>
<p class="lead" style="font-size: 1.2rem; max-width: 600px; margin: 0 auto; color: black;">Your intelligent safety companion powered by AI, community support, and real-time awareness.</p>
</div>
        <div class="card-grid" style="margin-bottom: 32px;">
<div class="card" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #951c1c);">
<h3 style="color: red; margin-bottom: 16px;"> Emergency Actions</h3>
<div class="quick" style="flex-direction: column; gap: 12px;">
<button id="quickSOS" class="primary" style="width: 100%; background: linear-gradient(135deg, var(--danger), #b11d1d);"> QUICK SOS</button>
<button id="simulateTap" class="ghost" style="width:100%; color: rgb(168,3,3);"><b>SIMULATE TAP</b></button>
</div>
</div>
<div class="card" style="text-align: center; background: linear-gradient(135deg, #dbeafe, #1a5bab);">
<h3 style="color: blue; margin-bottom: 16px;"> Detection Features</h3>
<div class="quick" style="flex-direction: column; gap: 12px;">
<button id="simulateShake" class="ghost" style="width:100%; color: rgb(2,2,190);"><b>SIMULATE SHAKE</b></button>
<button id="startVoice" class="ghost" style="width:100%; color: rgb(2,2,190);"><b>VOICE LISTEN</b></button>
</div>
</div>
</div>
<div style="text-align: center; padding: 24px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(240, 147, 251, 0.1)); border-radius: 16px; border: 2px solid rgba(102, 126, 234, 0.2);">
<h3 style="color: var(--accent-1); margin-bottom: 12px;"> Stay Protected, Stay Connected</h3>
<p class="lead" style="color: black;">Join thousands of users creating safer communities through technology and awareness.</p>
</div>
      </section>

      
      <section id="sos" class="screen" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #d5c1c1);">
        <h2>SOS Activation</h2>
        <p>Press the big button below to send an emergency alert.</p>
        <button id="sosBtnLarge" class="sos-large">SEND SOS</button>
        <div id="sosStatus" class="lead"></div>
      </section>

     
      <section id="mapScreen" class="screen" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #d5c1c1);">
        <h2>Live Map & Safety Zones</h2>
        <div class="controls">
          <button id="showMarkers">Show Markers</button>
          <button id="showHeat">Show Heatmap</button>
          <button id="clearReports">Clear Reports</button>
        </div>
        <div id="mapContainer">
          <div id="map"></div>
          <pre id="reportsPre" class="reportsPre">No reports yet.</pre>
        </div>
      </section>

      
      <section id="report" class="screen" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #d5c1c1);">
        <h2>Anonymous Reporting</h2>
        <form id="reportForm">
          <label>Type
            <select id="rType">
              <option value="harassment">Harassment</option>
              <option value="theft">Theft</option>
              <option value="violence">Violence</option>
              <option value="other">Other</option>
            </select>
          </label>
          <label>Description:
            <textarea id="rDesc" rows="4" required placeholder="Describe what happened..."></textarea>
          </label>
          <label class="inline">
            <p>Submit anonymously</p>
            <input type="checkbox" id="rAnon" checked />
          </label>
          <div class="formActions">
            <button type="submit" class="primary">Submit Report</button>
          </div>
        </form>
        <div id="reportStatus" class="lead"></div>
      </section>

      
      <section id="support" class="screen" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #d5c1c1);">
        <h2>Support & Resources</h2>
        <div class="card-grid">
          <div class="card">
            <h3>Emergency Hotline</h3>
            <p><b>Call 10111  or 112 from mobile.</b></p>
            <button class="primary" onclick="alert('Calling emergency...')">Call Now</button>
          </div>
          <div class="card">
            <h3>Counselling</h3>
            <p><b>Talk to a licensed counsellor for trauma or anxiety support.</b> <ul>
              <li>Explain that counselling offers a safe, confidential space for survivors to speak openly about their experiences.</li>
           <li> Emphasize emotional healing, trauma recovery, and rebuilding self-esteem.</li>
           <li> Include both in-person and online counselling options.</li>
              <li>Provide links to mental wellness articles, self-help exercises, and guided meditations.</li>

         <li> Include helpline contacts for emergency mental health support (local and national).</li>
          </ul></p>
            <button class="primary"><a href="tel:+27719657228">Chat with Counsellor</a></button>
          </div>
          <div class="card">
            <h3>Legal Help</h3>
            <p><b>Free legal aid for victims of harassment and abuse.</b>
              <ul>
                <li>Assistance with reporting cases of gender-based violence, assault, or harassment.</li>

                  <li>Guidance on filing protection orders (restraining orders) to ensure safety.</li>

              <li>Legal representation in court for survivors who cannot afford private lawyers.</li>

            <li>Support in lodging police reports and understanding your legal rights during the process.</li>
                <li>Help with documentation and evidence collection (e.g., medical reports, witness statements).</li>
            <li> Confidential consultations with trained legal professionals experienced in GBV cases.</li>
             <li> Information on workplace harassment laws and how to file complaints.</li>
             <li>Access to free or low-cost paralegal services for rural and vulnerable communities.</li> 
             <li>Referrals to government or NGO legal services for long-term case support.</li> 
             <li> Education on your legal rights ‚Äî understanding what protection the law provides against abuse.</li>
              <li>Assistance for minors and vulnerable persons through child protection and social workers.</li>
              </ul>
              <i>Follow-up legal support to ensure justice and survivor safety even after court proceedings.</i>
            </p>
            <button class="primary">Contact Legal Advisor</button>
          </div>
        </div>
      </section>

      
      <section id="education" class="screen" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #d5c1c1);">
        <h2>Education Hub</h2>
        <p><b>Learn about your rights, self-defence, and mental health awareness.</b></p>
        <div class="card-grid">
          <div class="card"><h3>Know Your Rights</h3><p><b>Your Legal and Personal Rights in GBV Situations</b>
<ul>
<li>You have the right to live free from any form of abuse ‚Äî physical, emotional, sexual, or financial.</li>
<li>You can report GBV to any police station ‚Äî the police must assist you immediately.</li>
<li>You have the right to apply for a Protection Order (restraining order) to keep the abuser away.</li>
<li>Hospitals must provide free emergency medical treatment and help collect evidence.</li>
<li>Your personal information must be kept private and confidential.</li>
<li>You can insist on respectful treatment from police, doctors, or legal officers.</li>
<li>You have the right to free counselling and shelter if you are unsafe at home.</li>
<li>Online abuse (harassment, sharing private photos, or threats) is also a crime ‚Äî and you can report it.</li></ul>

<i>SafeTap helps you report abuse safely, connect to legal aid, and find protection resources.</i> </p></div>
          
          <div class="card"><h3>Self-Defence Basics</h3><p><b>Simple Steps to Protect Yourself Safely</b>
<ul>
<li>Stay aware of your surroundings ‚Äî trust your instincts if something feels wrong.</li>
<li>Use your voice ‚Äî shout ‚ÄúNO!‚Äù or ‚ÄúHELP!‚Äù to attract attention.</li>
<li>Keep keys, alarms, or SafeTap SOS accessible for emergencies.</li>
<li>Create distance ‚Äî step back, block, or push away if someone approaches aggressively.</li>
<li>Target vulnerable areas (eyes, throat, knees) if you must defend yourself.</li>
<li>Take basic self-defence classes ‚Äî SafeTap can list nearby workshops.</li>
<li>Avoid confrontation if possible ‚Äî escaping to safety is the first goal.</li>
<li>Keep your location sharing on in the SafeTap app when walking alone at night.</li>
</ul>
<i> Self-defence is about protection, not violence ‚Äî use it only to escape danger.</i></p></div>
          <br>
          <div class="card"><h3>Mental Health</h3><p><b>Emotional Healing and Support After GBV</b> 
<ul>
<li>It‚Äôs normal to feel fear, anger, shame, or confusion ‚Äî you are not alone.</li>
<li>Speak to a trusted friend, counsellor, or mental health professional ‚Äî talking helps you heal.</li>
<li>You have the right to trauma counselling and psychological support services after abuse.</li>
<li>Practice self-care: sleep, eat properly, and take time to rest.</li>
<li>>Avoid isolation ‚Äî join survivor support groups or community healing programs.</li>
<li>Breathing and relaxation exercises can reduce panic and anxiety.</li>
<li>You can use SafeTap‚Äôs Resources to access hotlines, online therapy links, or nearby users.</li>
</ul>
<i> mental recovery is part of justice ‚Äî healing your mind empowers your future.</i></p></div>
        </div>
      </section>

      
      <section id="admin" class="screen" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #d5c1c1);">
        <h2>Community Impact Dashboard</h2>
        <canvas id="chart" width="400" height="200"></canvas>
        <p class="lead">Visualizing reports and SOS activity.</p>
      </section>

      <!-- SETTINGS -->
      <section id="settings" class="screen" style="text-align: center; background: linear-gradient(135deg, #fee2e2, #d5c1c1);">
        <h2>Settings & Profile</h2>
        <label>Preferred Language:
          <select id="langSelect">
            <option>English</option>
            <option>Zulu</option>
            <option>Sesotho</option>
          </select>
        </label>
        <label>Alert Method:
          <select id="alertMethod">
            <option>Push Notification</option>
            <option>SMS</option>
            <option>Email</option>
          </select>
        </label>
        <label>Trusted Contact:
          <input type="text" id="trustedContact" placeholder="+27..." />
        </label>
        <button class="primary" onclick="alert('Settings saved!')">Save Settings</button>
      </section>
    </main>

    <footer>
      <small style="color: rgb(0, 0, 0);">&copy; 2025 SafeTap Sphere - Built for FNB Hackathon by TUT Students</small>
    </footer>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
const $ = s => document.querySelector(s);
const $$ = s => document.querySelectorAll(s);
const STORAGE_KEY = "safetap_reports_v1";

// Navigation
$$('.topnav button').forEach(btn=>{
  btn.addEventListener('click',()=>{
    $$('.topnav button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    $$('.screen').forEach(sec=>sec.classList.remove('active'));
    const id = btn.dataset.screen === 'map' ? 'mapScreen' : btn.dataset.screen;
    $('#'+id).classList.add('active');
  });
});

// Storage & reports
function loadReports(){return JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]");}
function saveReports(r){localStorage.setItem(STORAGE_KEY,JSON.stringify(r));}
function renderReports(){const pre=$('#reportsPre');const r=loadReports();pre.textContent=r.length?JSON.stringify(r,null,2):'No reports yet.';}

async function createReport({type,description,anonymous}){
  let lat=-33.9,lon=18.4;
  try{const pos=await new Promise((res,rej)=>navigator.geolocation.getCurrentPosition(res,rej,{timeout:3000}));
    lat=pos.coords.latitude;lon=pos.coords.longitude;
  }catch{}
  const rep={id:Date.now(),type,description,anonymous,lat,lon,ts:new Date().toISOString()};
  const arr=loadReports();arr.push(rep);saveReports(arr);renderReports();return rep;
}

// SOS + Quick Triggers
$('#quickSOS').onclick=()=>{createReport({type:'SOS',description:'Quick SOS',anonymous:true});alert('Quick SOS recorded!');};
$('#simulateTap').onclick=()=>{createReport({type:'Tap',description:'Tap trigger',anonymous:true});alert('Tap simulated');};
$('#simulateShake').onclick=()=>{createReport({type:'Shake',description:'Shake simulated',anonymous:true});alert('Shake simulated');};
$('#sosBtnLarge').onclick=async()=>{$('#sosStatus').textContent='Sending SOS...';const r=await createReport({type:'SOS',description:'SOS activated',anonymous:false});$('#sosStatus').textContent='SOS logged ID '+r.id;};

// Report Form
$('#reportForm').onsubmit=async e=>{
  e.preventDefault();
  const type=$('#rType').value,desc=$('#rDesc').value,anon=$('#rAnon').checked;
  const r=await createReport({type,description:desc,anonymous:anon});
  $('#reportStatus').textContent='Report saved (id '+r.id+')';
  $('#rDesc').value='';
};

// Map + Heatmap
const map=L.map('map').setView([-33.9258,18.4233],13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19}).addTo(map);
let markerLayer=L.layerGroup().addTo(map),heatLayer=null;

function showMarkers(){
  markerLayer.clearLayers();
  const r=loadReports();
  r.forEach(x=>L.marker([x.lat,x.lon]).bindPopup('<b>'+x.type+'</b><br>'+x.description).addTo(markerLayer));
  if(r.length) map.fitBounds(markerLayer.getBounds());
}
function showHeat(){
  if(heatLayer) map.removeLayer(heatLayer);
  const pts=loadReports().map(x=>[x.lat,x.lon,0.6]);
  heatLayer=L.heatLayer(pts,{radius:25}).addTo(map);
}
$('#showMarkers').onclick=showMarkers;
$('#showHeat').onclick=showHeat;
$('#clearReports').onclick=()=>{localStorage.removeItem(STORAGE_KEY);markerLayer.clearLayers();if(heatLayer)map.removeLayer(heatLayer);renderReports();};

// Voice Recognition
let recognition;
if('webkitSpeechRecognition' in window){
  recognition=new webkitSpeechRecognition();
  recognition.continuous=true;
  recognition.onresult=async e=>{
    const text=e.results[e.resultIndex][0].transcript.toLowerCase();
    if(text.includes('help')||text.includes('safe tap')){
      await createReport({type:'Voice',description:text,anonymous:true});
      alert('Voice-triggered SOS detected!');
    }
  };
}
$('#startVoice').onclick=()=>{if(recognition){recognition.start();alert('Listening... say "Help me"');}else alert('Voice recognition not supported');};

// Admin Dashboard Chart
const ctx=document.getElementById('chart');
const chart=new Chart(ctx,{type:'bar',data:{labels:['SOS','Tap','Shake','Voice','Report'],
datasets:[{label:'Incident Counts',data:[3,2,1,1,4],backgroundColor:'rgba(106,90,249,0.6)'}]},options:{plugins:{legend:{display:false}}}});

// Init
renderReports();
showMarkers();
  </script>


<!-- ================== POWER BUTTON SOS SIMULATION ================== -->
<section id="powerSOS" class="screen">
  <h2>Power Button SOS (Simulation)</h2>
  <p class="lead">In a real mobile app, triple-pressing the power button would trigger an automatic SOS alert.
  This simulation lets you test that behavior on the web.</p>

  <button id="simulatePower" class="primary">Simulate Triple Power Press</button>

  <div id="powerStatus" class="lead"></div>
</section>

<script>
let powerClickCount = 0;
let lastPowerClickTime = 0;

// Simulate triple-press detection
document.getElementById('simulatePower').addEventListener('click', async () => {
  const now = Date.now();
  if (now - lastPowerClickTime < 800) powerClickCount++;
  else powerClickCount = 1;
  lastPowerClickTime = now;

  if (powerClickCount === 3) {
    powerClickCount = 0;
    document.getElementById('powerStatus').textContent = 'Triple power press detected! Sending SOS...';

    // Get current location
    navigator.geolocation.getCurrentPosition(async pos => {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;

      // Save report
      const rep = await createReport({
        type: 'PowerSOS',
        description: 'Triggered via triple power press',
        anonymous: false
      });

      // Mark user path on map
      const userMarker = L.marker([lat, lon]).addTo(markerLayer)
        .bindPopup('<b>Power SOS Triggered</b><br>Location shared.');
      map.setView([lat, lon], 15);

      document.getElementById('powerStatus').textContent =
        `SOS sent! Location: ${lat.toFixed(4)}, ${lon.toFixed(4)}`;
    }, () => {
      document.getElementById('powerStatus').textContent =
        'Unable to access location.';
    });
  }
});
</script>

</body>
</html>
